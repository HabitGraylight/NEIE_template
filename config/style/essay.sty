\ProvidesPackage{essay}[2025/03/26 Essay formatting for Chongqing University]

\RequirePackage{fancyhdr} % 页眉页脚设置
\RequirePackage{titlesec} % 标题格式设置
\RequirePackage{caption}  % 图表标题格式设置
\RequirePackage{booktabs} % 表格线设置
\RequirePackage{amsmath}  % 数学公式支持
\RequirePackage{amssymb}  % 数学符号支持

% 页面设置
\fancypagestyle{essaystyle}{
  \fancyhf{} % 清空默认页眉页脚
  \fancyhead[CE]{\footnotesize 重庆大学本科学生毕业论文（设计）} % 偶数页页眉左侧
  \fancyhead[CO]{\footnotesize \leftmark} % 奇数页页眉为节标题
  \fancyfoot[C]{\footnotesize \thepage} % 页脚显示页码
  \renewcommand{\headrulewidth}{0.4pt} % 页眉下划线
  \renewcommand{\footrulewidth}{0pt} % 页脚无下划线 
}
\renewcommand{\thesection}{\arabic{section}} % 设置节编号为阿拉伯数字
% 标题格式设置
\titleformat{\chapter}[hang]{\bfseries\zihao{-2}}{\thechapter}{1em}{}
% \titleformat{\section}[hang]{\bfseries\zihao{3}}{\thesection}{1em}{}
\titleformat{\section}[hang] % 悬挂式对齐
  {\normalfont\zihao{-3}\bfseries\filcenter} % 三号黑体居中
  {\thesection\ } % 编号后加空格
  {1pt} % 标签与标题间距
  {} % 前缀格式
  %这里设置了很多次,可以设一个中心样式文件统一管理,这里懒得改了,多的我直接注释或者放进环境中了,这次的应该是全局生效的
\titleformat{\subsection}[hang]{\bfseries\zihao{-3}}{\thesubsection}{1em}{}
\titleformat{\subsubsection}[hang]{\bfseries\zihao{4}}{\thesubsubsection}{1em}{}

% 标题间距设置
\titlespacing*{\chapter}{0pt}{*2}{*1} % 章标题前后间距
\titlespacing*{\section}{0pt}{*1.5}{*0.5} % 节标题前后间距
\titlespacing*{\subsection}{0pt}{*1}{*0.5} % 小节标题前后间距
\titlespacing*{\subsubsection}{0pt}{*0.5}{*0.5} % 小小节标题前后间距

% 表格标题格式
\captionsetup[table]{
  font={small}, % 五号字体
  labelfont={bf}, % 加粗
  labelsep=space, % 标签与标题之间空格
  justification=centering, % 居中对齐
  skip=5pt % 标题与表格之间的间距
}

% 图标题格式
\captionsetup[figure]{
  font={small}, % 五号字体
  labelfont={bf}, % 加粗
  labelsep=space, % 标签与标题之间空格
  justification=centering, % 居中对齐
  skip=5pt % 标题与图之间的间距
}
% 图编号格式
\renewcommand{\thefigure}{\thesection.\arabic{figure}}
\numberwithin{figure}{section} % 按节编号图，例如 3.1

% 表编号格式
\renewcommand{\thetable}{\thesection.\arabic{table}}
\numberwithin{table}{section} % 按节编号表，例如 3.1

% 数学公式编号格式
\numberwithin{equation}{section} % 按节编号公式，例如 3.1
\renewcommand{\theequation}{\thesection.\arabic{equation}}

% 段落设置
\setlength{\parindent}{2em} % 首行缩进2字符
\setlength{\parskip}{0em} % 段间距为0

% 页码设置
% 下面的弃用了...
\newenvironment{essaysection}{
    \begingroup % 开始局部环境
    \pagestyle{essaystyle} % 启用 essaystyle 样式
}{
    \par % 结束段落
    \endgroup % 恢复之前的样式
}